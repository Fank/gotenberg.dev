"use strict";(self.webpackChunkgotenberg_dev=self.webpackChunkgotenberg_dev||[]).push([[925],{4137:(e,t,a)=>{a.d(t,{Zo:()=>p,kt:()=>m});var r=a(7294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function u(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},l=Object.keys(e);for(r=0;r<l.length;r++)a=l[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)a=l[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var i=r.createContext({}),s=function(e){var t=r.useContext(i),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},p=function(e){var t=s(e.components);return r.createElement(i.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var a=e.components,n=e.mdxType,l=e.originalType,i=e.parentName,p=u(e,["components","mdxType","originalType","parentName"]),d=s(a),m=n,h=d["".concat(i,".").concat(m)]||d[m]||c[m]||l;return a?r.createElement(h,o(o({ref:t},p),{},{components:a})):r.createElement(h,o({ref:t},p))}));function m(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var l=a.length,o=new Array(l);o[0]=d;var u={};for(var i in t)hasOwnProperty.call(t,i)&&(u[i]=t[i]);u.originalType=e,u.mdxType="string"==typeof e?e:n,o[1]=u;for(var s=2;s<l;s++)o[s]=a[s];return r.createElement.apply(null,o)}return r.createElement.apply(null,a)}d.displayName="MDXCreateElement"},425:(e,t,a)=>{a.d(t,{Z:()=>o});var r=a(7294),n=a(6010);const l="tabItem_Ymn6";function o(e){let{children:t,hidden:a,className:o}=e;return r.createElement("div",{role:"tabpanel",className:(0,n.Z)(l,o),hidden:a},t)}},3992:(e,t,a)=>{a.d(t,{Z:()=>N});var r=a(7462),n=a(7294),l=a(6010),o=a(2957),u=a(6775),i=a(5238),s=a(3609),p=a(2560);function c(e){return function(e){return n.Children.map(e,(e=>{if(!e||(0,n.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}(e).map((e=>{let{props:{value:t,label:a,attributes:r,default:n}}=e;return{value:t,label:a,attributes:r,default:n}}))}function d(e){const{values:t,children:a}=e;return(0,n.useMemo)((()=>{const e=t??c(a);return function(e){const t=(0,s.l)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,a])}function m(e){let{value:t,tabValues:a}=e;return a.some((e=>e.value===t))}function h(e){let{queryString:t=!1,groupId:a}=e;const r=(0,u.k6)(),l=function(e){let{queryString:t=!1,groupId:a}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!a)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return a??null}({queryString:t,groupId:a});return[(0,i._X)(l),(0,n.useCallback)((e=>{if(!l)return;const t=new URLSearchParams(r.location.search);t.set(l,e),r.replace({...r.location,search:t.toString()})}),[l,r])]}function f(e){const{defaultValue:t,queryString:a=!1,groupId:r}=e,l=d(e),[o,u]=(0,n.useState)((()=>function(e){let{defaultValue:t,tabValues:a}=e;if(0===a.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!m({value:t,tabValues:a}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${a.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const r=a.find((e=>e.default))??a[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:t,tabValues:l}))),[i,s]=h({queryString:a,groupId:r}),[c,f]=function(e){let{groupId:t}=e;const a=function(e){return e?`docusaurus.tab.${e}`:null}(t),[r,l]=(0,p.Nk)(a);return[r,(0,n.useCallback)((e=>{a&&l.set(e)}),[a,l])]}({groupId:r}),k=(()=>{const e=i??c;return m({value:e,tabValues:l})?e:null})();(0,n.useLayoutEffect)((()=>{k&&u(k)}),[k]);return{selectedValue:o,selectValue:(0,n.useCallback)((e=>{if(!m({value:e,tabValues:l}))throw new Error(`Can't select invalid tab value=${e}`);u(e),s(e),f(e)}),[s,f,l]),tabValues:l}}var k=a(1048);const b="tabList__CuJ",v="tabItem_LNqP";function y(e){let{className:t,block:a,selectedValue:u,selectValue:i,tabValues:s}=e;const p=[],{blockElementScrollPositionUntilNextRender:c}=(0,o.o5)(),d=e=>{const t=e.currentTarget,a=p.indexOf(t),r=s[a].value;r!==u&&(c(t),i(r))},m=e=>{let t=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const a=p.indexOf(e.currentTarget)+1;t=p[a]??p[0];break}case"ArrowLeft":{const a=p.indexOf(e.currentTarget)-1;t=p[a]??p[p.length-1];break}}t?.focus()};return n.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,l.Z)("tabs",{"tabs--block":a},t)},s.map((e=>{let{value:t,label:a,attributes:o}=e;return n.createElement("li",(0,r.Z)({role:"tab",tabIndex:u===t?0:-1,"aria-selected":u===t,key:t,ref:e=>p.push(e),onKeyDown:m,onClick:d},o,{className:(0,l.Z)("tabs__item",v,o?.className,{"tabs__item--active":u===t})}),a??t)})))}function g(e){let{lazy:t,children:a,selectedValue:r}=e;const l=(Array.isArray(a)?a:[a]).filter(Boolean);if(t){const e=l.find((e=>e.props.value===r));return e?(0,n.cloneElement)(e,{className:"margin-top--md"}):null}return n.createElement("div",{className:"margin-top--md"},l.map(((e,t)=>(0,n.cloneElement)(e,{key:t,hidden:e.props.value!==r}))))}function T(e){const t=f(e);return n.createElement("div",{className:(0,l.Z)("tabs-container",b)},n.createElement(y,(0,r.Z)({},e,t)),n.createElement(g,(0,r.Z)({},e,t)))}function N(e){const t=(0,k.Z)();return n.createElement(T,(0,r.Z)({key:String(t)},e))}},6071:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>p,contentTitle:()=>i,default:()=>m,frontMatter:()=>u,metadata:()=>s,toc:()=>c});var r=a(7462),n=(a(7294),a(4137)),l=a(3992),o=a(425);const u={id:"api",title:"API"},i=void 0,s={unversionedId:"modules/api",id:"modules/api",title:"API",description:"The API module is an HTTP/1 and HTTP/2 (H2C) server. Other modules may add routes, middlewares, and health checks.",source:"@site/docs/modules/api.mdx",sourceDirName:"modules",slug:"/modules/api",permalink:"/docs/modules/api",draft:!1,editUrl:"https://github.com/gotenberg/gotenberg.dev/edit/main/docs/modules/api.mdx",tags:[],version:"current",frontMatter:{id:"api",title:"API"},sidebar:"version-7.x",previous:{title:"Cloud Run",permalink:"/docs/get-started/cloud-run"},next:{title:"Chromium",permalink:"/docs/modules/chromium"}},p={},c=[{value:"Properties",id:"properties",level:2},{value:"Routes",id:"routes",level:2},{value:"Health",id:"health",level:3},{value:"Modules",id:"modules",level:3},{value:"multipart/form-data",id:"multipartform-data",level:4},{value:"Other routes",id:"other-routes",level:4},{value:"Middlewares",id:"middlewares",level:2},{value:'Trace <span class="badge badge--secondary">all routes</span>',id:"trace-all-routes",level:3},{value:'Timeout <span class="badge badge--secondary">all routes</span>',id:"timeout-all-routes",level:3},{value:'Output Filename <span class="badge badge--secondary">multipart</span>',id:"output-filename-multipart",level:3},{value:"Modules",id:"modules-1",level:3}],d={toc:c};function m(e){let{components:t,...a}=e;return(0,n.kt)("wrapper",(0,r.Z)({},d,a,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("p",null,"The API module is an HTTP/1 and HTTP/2 (H2C) server. Other modules may add routes, middlewares, and health checks."),(0,n.kt)("h2",{id:"properties"},"Properties"),(0,n.kt)(l.Z,{defaultValue:"port",values:[{label:"Port",value:"port"},{label:"Timeout",value:"timeout"},{label:"Root path",value:"root_path"},{label:"Trace",value:"trace"},{label:"Health",value:"health"}],mdxType:"Tabs"},(0,n.kt)(o.Z,{value:"port",mdxType:"TabItem"},(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"--api-port          int     Set the port on which the API should listen (default 3000)\n--api-port-from-env string  Set the environment variable with the port on which the API should listen - override the default port\n"))),(0,n.kt)(o.Z,{value:"timeout",mdxType:"TabItem"},(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"--api-timeout duration  Set the time limit for requests (default 30s)\n")),(0,n.kt)("admonition",{type:"caution"},(0,n.kt)("p",{parentName:"admonition"},"The properties ",(0,n.kt)("inlineCode",{parentName:"p"},"--api-read-timeout"),", ",(0,n.kt)("inlineCode",{parentName:"p"},"--api-process-timeout")," and ",(0,n.kt)("inlineCode",{parentName:"p"},"--api-write-timeout")," are deprecated in favor of\n",(0,n.kt)("inlineCode",{parentName:"p"},"--api-timeout"),"."))),(0,n.kt)(o.Z,{value:"root_path",mdxType:"TabItem"},(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},'--api-root-path string  Set the root path of the API - for service discovery via URL paths (default "/")\n'))),(0,n.kt)(o.Z,{value:"trace",mdxType:"TabItem"},(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},'--api-trace-header string  Set the header name to use for identifying requests (default "Gotenberg-Trace")\n'))),(0,n.kt)(o.Z,{value:"health",mdxType:"TabItem"},(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"--api-disable-health-check-logging bool  Disable health check logging\n")))),(0,n.kt)("h2",{id:"routes"},"Routes"),(0,n.kt)("h3",{id:"health"},"Health"),(0,n.kt)("p",null,(0,n.kt)("inlineCode",{parentName:"p"},"GET /health")),(0,n.kt)(l.Z,{defaultValue:"success",values:[{label:"Success",value:"success"},{label:"Error",value:"error"}],mdxType:"Tabs"},(0,n.kt)(o.Z,{value:"success",mdxType:"TabItem"},(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"Status: 200 OK\n\nContent-Type: application/json\nGotenberg-Trace: {trace}\n\nBody:\n")),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "status": "up",\n    "details": {\n        "moduleX": {\n            "status": "up",\n            "timestamp": "2021-07-01T08:05:14.603364Z"\n        },\n        "moduleY": {\n            "status": "up",\n            "timestamp": "2021-07-01T08:05:14.603364Z"\n        },\n    }\n}\n'))),(0,n.kt)(o.Z,{value:"error",mdxType:"TabItem"},(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"Status: 503 Service Unavailable\n\nContent-Type: application/json\nGotenberg-Trace: {trace}\n\nBody:\n")),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "status": "down",\n    "details": {\n        "moduleX": {\n            "status": "up",\n            "timestamp": "2021-07-01T08:05:14.603364Z"\n        },\n        "moduleY": {\n            "status": "down",\n            "timestamp": "2021-07-01T08:05:14.603364Z",\n            "error": "An health check error"\n        },\n    }\n}\n')))),(0,n.kt)("p",null,"The ",(0,n.kt)("inlineCode",{parentName:"p"},"details")," section gathers the health checks from modules. If none, this entry is not present."),(0,n.kt)("p",null,"Currently, only the following module provides a health check:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"libreoffice#health-check"},"LibreOffice"))),(0,n.kt)("h3",{id:"modules"},"Modules"),(0,n.kt)("h4",{id:"multipartform-data"},"multipart/form-data"),(0,n.kt)("p",null,(0,n.kt)("inlineCode",{parentName:"p"},"METHOD /forms/{module}/{handler}")),(0,n.kt)("p",null,"The following modules provide ",(0,n.kt)("inlineCode",{parentName:"p"},"multipart/form-data")," routes:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"chromium"},"Chromium")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"libreoffice"},"LibreOffice")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"pdf-engines"},"PDF Engines"))),(0,n.kt)(l.Z,{defaultValue:"success",values:[{label:"Success",value:"success"},{label:"Error",value:"error"}],mdxType:"Tabs"},(0,n.kt)(o.Z,{value:"success",mdxType:"TabItem"},(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"Status: 200 OK\n\nContent-Disposition: attachement; filename={output-filename.ext}\nContent-Type: {content-type}\nContent-Length: {content-length}\nGotenberg-Trace: {trace}\n\nBody: {output-file}\n"))),(0,n.kt)(o.Z,{value:"error",mdxType:"TabItem"},(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"Status: {status}\n\nContent-Type: text/plain; charset=UTF-8\nGotenberg-Trace: {trace}\n\nBody: {error}\n")))),(0,n.kt)("hr",null),(0,n.kt)("h4",{id:"other-routes"},"Other routes"),(0,n.kt)("p",null,(0,n.kt)("inlineCode",{parentName:"p"},"METHOD /{module}/{handler}")),(0,n.kt)("p",null,"Currently, only the following module provides a non-",(0,n.kt)("inlineCode",{parentName:"p"},"multipart/form-data")," route:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"prometheus"},"Prometheus"))),(0,n.kt)("h2",{id:"middlewares"},"Middlewares"),(0,n.kt)("h3",{id:"trace-all-routes"},"Trace ",(0,n.kt)("span",{class:"badge badge--secondary"},"all routes")),(0,n.kt)("p",null,"The trace, or request ID, identifies a request in the logs."),(0,n.kt)("p",null,"By default, the API generates a ",(0,n.kt)("em",{parentName:"p"},"UUID")," trace for each request. However, you may also specify the trace per request,\nthanks to the ",(0,n.kt)("inlineCode",{parentName:"p"},"Gotenberg-Trace")," header."),(0,n.kt)("p",null,"For instance:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash",metastring:"{3}","{3}":!0},"curl \\\n--request POST 'http://localhost:3000/forms/chromium/convert/url' \\\n--header 'Gotenberg-Trace: debug' \\\n--form 'url=\"https://my.url\"' \\\n-o my.pdf\n")),(0,n.kt)("admonition",{type:"info"},(0,n.kt)("p",{parentName:"admonition"},"The API adds a header ",(0,n.kt)("inlineCode",{parentName:"p"},"Gotenberg-Trace")," to each response. If you're using the webhook feature, it also adds the header\nto each request to your callbacks.")),(0,n.kt)("admonition",{type:"tip"},(0,n.kt)("p",{parentName:"admonition"},"You may customize the trace header thanks to the ",(0,n.kt)("inlineCode",{parentName:"p"},"--api-trace-header")," property.")),(0,n.kt)("h3",{id:"timeout-all-routes"},"Timeout ",(0,n.kt)("span",{class:"badge badge--secondary"},"all routes")),(0,n.kt)("p",null,"The API returns a ",(0,n.kt)("inlineCode",{parentName:"p"},"503 Service Unavailable")," response if a request fails to finish before a given duration."),(0,n.kt)("admonition",{type:"tip"},(0,n.kt)("p",{parentName:"admonition"},"You may customize the time limit thanks to the ",(0,n.kt)("inlineCode",{parentName:"p"},"--api-timeout")," property.")),(0,n.kt)("admonition",{type:"info"},(0,n.kt)("p",{parentName:"admonition"},"The API will close the socket if it fails to read the request body before the time limit. It will also close the socket\nif the API fails to write the response after a duration equal to two times the time limit. However, this scenario is\nunlikely.")),(0,n.kt)("h3",{id:"output-filename-multipart"},"Output Filename ",(0,n.kt)("span",{class:"badge badge--secondary"},"multipart")),(0,n.kt)("p",null,"By default, the API generates a ",(0,n.kt)("em",{parentName:"p"},"UUID")," filename. However, you may also specify the filename per request, thanks to\nthe ",(0,n.kt)("inlineCode",{parentName:"p"},"Gotenberg-Output-Filename")," header."),(0,n.kt)("p",null,"For instance:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash",metastring:"{3}","{3}":!0},"curl \\\n--request POST 'http://localhost:3000/forms/chromium/convert/url' \\\n--header 'Gotenberg-Output-Filename: result' \\\n--form 'url=\"https://my.url\"' \\\n-O -J\n")),(0,n.kt)("admonition",{type:"caution"},(0,n.kt)("p",{parentName:"admonition"},"The API adds the file extension automatically; you don't have to set it.")),(0,n.kt)("h3",{id:"modules-1"},"Modules"),(0,n.kt)("p",null,"Currently, only the following module provides a middleware:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"webhook"},"Webhook"))))}m.isMDXComponent=!0}}]);